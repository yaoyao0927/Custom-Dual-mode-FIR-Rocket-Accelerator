#include<stdio.h>
#include "rocc.h"
#include "encoding.h"

#define SIZE 3600    // The size of sampled signal
#define N 16         // The tap number of filter
#define M (N + 1)   // The length of filter

long long delay[N] = {0}; 

// FIR function
long long fir_filter(unsigned long long input) {
	long long temp = 0;
	// fp:50Hz  fs:80Hz   Fs:360Hz  wp:0.8   ws:1.5
	//long long coeff[N] = {23711, 106071, 196296, 255436, 
							//255436, 196296, 106071, 23711}; 
	long long coeff[N] = {239, -23729, -44490, -37961, 
			     		12762, 102193, 199636, 263220, 
						263220, 199636, 102193, 12762, 
						-37961, -44490, -23729, 239}; 

	// fp:0.7Hz  fs:1Hz   Fs:360Hz  wp:1   ws:1
	//long long coeff[N] = {-90800, -127200, -212100, -636600, 
							// 636600, 212100, 127200, 90800}; 
	//long long coeff[N] = {-42100, -48700, -57600, -70500, 
							// -90800, -127200, -212100, -636600, 
							// 636600, 212100, 127200, 90800, 
							// 70500, 57600, 48700, 42100}; 

	// TDL
    for (int i = N - 1; i > 0; i--) {
        delay[i] = delay[i - 1];
    }
    delay[0] = input;

    // MAC 
    for (int i = 0; i < N; i++) {
        temp += coeff[i] * delay[i];
    }
    return temp;
}


int main(void){
	long long  swFIRRes[SIZE] = {0};
	long long  hwFIRRes[SIZE] = {0};	
	long long sampled_signal[] = {-34616,-34233,-33849,-33465,-33081,-32697,-32313,-31929,-31545,-31161,-15777,-35393,-60009,-74626,-94242,-83858,-73474,-98090,-87707,-117323,
-126939,-116556,-106172,-95788,-110405,-120021,-114638,-109254,-93871,-88488,-103104,-112721,-117338,-116955,-101572,-101188,-95805,-110422,-115040,-104657,
-89274,-88891,-73508,-108126,-117743,-102361,-81978,-91596,-96214,-100831,-95449,-90067,-69685,-64303,-73921,-98539,-103158,-97776,-87395,-77013,
-91632,-111250,-110869,-115488,-85107,-104726,-109345,-123964,-113584,-108203,-102823,-112442,-107062,-116682,-116302,-105922,-90542,-95162,-99783,-114403,
-114024,-93645,-93265,-102886,-97508,-112129,-121750,-116371,-100993,-100615,-105236,-124858,-129480,-114103,-108725,-98347,-112970,-107593,-112216,-101839,
-86462,-81085,-80709,-80332,-74956,-74580,-49204,-28828,-33452,-48077,-47701,-32326,-21951,-31576,-26202,-65827,-50453,-55078,-39704,-34330,
-48957,-78583,-93210,-77836,-82463,-77090,-101718,-106345,-115973,-95601,-100229,-94857,-124485,-144114,-153743,-138372,-133001,-132630,-147260,-151889,
-166519,-151149,-130780,-140410,-170041,-159672,-174303,-163934,-163566,-163197,-172829,-177462,-187094,-176726,-156359,-165992,-170626,-185259,-189893,-179527,
-174161,-153795,-168430,-188064,-177699,-167335,-156970,-151606,-161242,-175878,-180514,-165151,-154788,-139425,-129062,-118700,-108338,-67976,-22614,32747,
98108,178469,248830,289190,289550,254910,155270,35629,-24012,-23653,46706,157064,277422,412780,553137,668495,743852,754208,664565,529921,
410277,305632,215988,111343,-13303,-122948,-222594,-312240,-366886,-406533,-431180,-415827,-375475,-345123,-299771,-254419,-249068,-238717,-248366,-228016,
-232666,-217316,-226967,-231617,-236269,-205920,-200572,-185224,-189876,-209529,-209182,-198835,-198489,-193143,-187797,-207452,-202107,-186762,-166418,-156073,
-140730,-170386,-170043,-159700,-144358,-144016,-143674,-153333,-152992,-127651,-102310,-81970,-86631,-86291,-75952,-60613,-45275,-24937,-29599,-24262,
-18925,-3589,26748,22084,52419,47754,53089,93423,113758,124091,129425,129758,140090,160422,185754,191086,181417,181748,182078,212408,
227738,243067,233396,218724,194052,194380,189707,165034,135361,90687,66013,46338,26663,11988,-7688,-42364,-67041,-66718,-56395,-61073,
-75751,-95429,-125108,-109788,-104468,-94148,-108828,-133509,-128191,-117873,-117555,-112238,-131921,-161604,-141288,-130972,-125657,-120342,-120028,-129714,
-149400,-134087,-128775,-118462,-128151,-142839,-137528,-122218,-106908,-126598,-121289,-130980,-130671,-140364,-115056,-114749,-114442,-119136,-123831,-133525,
-118221,-117916,-117612,-122309,-137006,-111703,-96401,-101099,-120798,-135498,-130197,-104897,-104598,-84299,-104001,-123703,-133405,-128108,-117812,-102516,
-107220,-111925,-121630,-116336,-111042,-125749,-125456,-125164,-144872,-129581,-114290,-109000,-128710,-138420,-133131,-132843,-117555,-112267,-126980,-151694,
-136408,-121123,-100837,-90553,-90269,-104985,-99702,-84420,-79138,-78856,-93575,-108295,-103015,-82735,-52456,-37178,-56900,-41622,-41345,-31069,
-30793,-35517,-60243,-69968,-79694,-74421,-74148,-68876,-68604,-88333,-88062,-87792,-77522,-82253,-106984,-126716,-136448,-131181,-125914,-120648,
-130383,-145118,-164854,-169590,-159326,-139063,-148801,-143539,-143278,-148018,-132757,-137498,-152239,-151980,-166722,-161465,-166208,-175952,-170696,-175441,
-185186,-174932,-149679,-149426,-154173,-158921,-178670,-153419,-153169,-137919,-152670,-162422,-157174,-156926,-146679,-131433,-141188,-140942,-145698,-160454,
-125210,-99967,-104725,-99483,-94242,-44002,11238,56478,106717,171955,237192,302430,367666,387902,358137,293372,238606,138840,84073,64305,
84537,119769,204999,315229,445459,540688,620916,661144,661371,646597,586823,497049,407273,322498,247721,187944,123166,38388,-41391,-126170,
-195950,-255731,-270512,-290294,-305076,-304860,-274643,-239428,-204213,-188998,-183784,-188571,-193358,-183146,-152935,-167724,-167514,-192304,-177095,-161887,
-156679,-161472,-166266,-166060,-170855,-165650,-160446,-150243,-140040,-169838,-164637,-149436,-134236,-124036,-138837,-153639,-138441,-138244,-118048,-107852,
-107657,-112462,-117269,-102075,-91883,-76691,-76499,-76309,-81119,-45929,-25741,-5552,-20365,-15178,-34992,-4806,20378,50563,35746,50929,
56112,71293,91474,101655,101834,102013,107192,132369,137547,147723,167899,163074,183248,208422,238595,238768,243940,239111,244281,274451,
304620,294789,309957,310124,290291,300456,295622,285786,265950,226113,211276,191438,191599,176759,156919,107079,92237,77395,67552,67709,
32864,33020,8174,3328,8481,3634,-6215,-26064,-30913,-10763,-614,4534,-10318,-30171,-45025,-34879,-24734,-24590,-39446,-29303,
-44161,-34020,-18879,-3738,-13599,-8460,-13322,-18185,1952,-7912,-7776,-17642,-22508,-17374,2758,17890,-1979,-16848,-6718,8411,
13539,18667,-1206,-6079,-25954,-829,4296,-581,-5458,-5336,-5214,-10093,10027,20146,5265,-19617,-9500,-9383,20732,25848,
-9038,-18924,-18811,-3699,21413,11524,1634,-8256,-23148,-13039,-2932,7175,-7719,-17614,-17509,-12406,-7302,-2200,-12098,-26997,
-21897,-11797,-16698,8400,-1503,-16406,-21310,-16215,-1120,3974,-20933,-15840,-20749,4342,14433,29522,24611,4699,14787,24874,
34960,50045,45129,45213,50296,40379,75461,80542,90622,90701,80780,90858,85936,101012,86088,71163,66238,51312,61385,66457,
51529,36599,31670,31739,46808,41876,31943,22009,2075,2140,17205,12268,-2669,2393,-12545,-7485,-7425,-22366,-27307,-17249,
-42192,-27136,-12080,-22025,-41971,-51918,-46865,-26813,-26762,-21712,-31662,-51613,-51564,-46517,-36470,-16424,-21379,-41334,-46290,-31247,
-31204,-16163,-26122,-26082,-41042,-26003,-5965,-20928,-20891,-20856,-30820,-15786,-752,9280,-5687,-10656,-5625,14405,49434,59462,
74490,74517,129543,194569,249594,329618,374641,419664,429686,419707,384727,319747,214766,149784,149801,214818,319834,439849,579864,689878,
789891,884903,944915,949925,879935,764945,654953,574961,489968,409975,319980,204985,89990,-7,-75004,-150002,-220001,-255001,-280001,-275002,
-235003,-200006,-170009,-140013,-125018,-105023,-70029,-60036,-55044,-60052,-80061,-55071,-50081,-45093,-40105,-50118,-50131,-40145,-25160,-15176,
-35192,-40210,-45227,-35246,-15266,-10286,-20307,-35328,-30350,-25374,-15397,4578,14553,-473,9500,9473,29444,34415,34386,24355,
19324,34292,59260,74226,69192,64157,79122,89085,104048,119011,123972,113933,128893,143852,158811,168769,183726,173682,173638,198593,
218547,243500,243453,233405,233356,268307,283256,298205,313154,308101,308048,317994,347940,357884,367828,367772,372714,387656,387597,407537,
422477,397416,392354,392291,402228,387164,367099,322033,306967,291900,276832,276764,241695,211625,181554,161483,161411,156338,116265,101191,
101116,106040,95964,100886,95809,65730,65651,70571,70490,70409,60326,50244,40160,45076,54991,64905,49818,44731,49643,39555,
49465,74375,49284,39193,29101,44008,63914,63820,53725,43629,48533,48435,48337,68239,53139,43039,27939,37837,47735,37632,
42528,27424,22319,32213,42107,42000,36892,21783,-3326,11564,36453,41342,31230,16117,16003,25889,50774,50659,45542,20425,
10308,20189,40070,39950,34830,24708,14587,14464,34341,44217,34092,18966,8840,28713,38586,33458,23329,18199,3069,7938,
17806,17674,12541,7407,2273,27138,17002,6865,6728,-18410,11452,26312,26172,26032,20890,15748,35606,65462,70318,65174,
45028,39882,49735,74588,84440,79291,64141,68991,78840,93689,98537,83384,63230,53076,57921,67765,62609,52452,32295,27136,
21977,31818,26657,26496,6335,-18828,-23991,846,5682,-19483,-29649,-44815,-19982,-10150,-10318,-40487,-65657,-85827,-75998,-51170,
-46342,-41515,-66688,-76863,-67038,-62213,-52389,-67566,-87744,-97922,-88101,-73280,-73460,-73641,-93822,-99004,-79187,-79370,-84555,-79739,
-99924,-110110,-85297,-100484,-100672,-90861,-106050,-111240,-101430,-86621,-86813,-82005,-92198,-97392,-87586,-77781,-67977,-83173,-93370,-88567,
-63765,-38964,-9163,5637,20436,55235,110033,184831,259628,304424,314220,319015,313809,283603,218396,118188,42980,2772,47562,137352,
247142,376931,466719,576506,691293,796080,855866,835651,765435,650219,555002,474785,379567,284349,169130,63910,-36310,-126531,-211753,-296975,
-342198,-382421,-392645,-357869,-343095,-308320,-293547,-278774,-249001,-204229,-184458,-179687,-184917,-195147,-195378,-180610,-160842,-166075,-191309,-181543,
-176777,-167012,-162248,-162484,-167721,-177959,-173197,-158435,-148675,-148914,-174155,-164396,-154637,-154879,-150122,-140365,-145609,-155853,-151098,-136344,
-126590,-116836,-127084,-127331,-122580,-102829,-83078,-98328,-113579,-108830,-84081,-69334,-64587,-49840,-50094,-45348,-35603,-20859,-1115,3628,
8371,18114,17855,47596,67337,72077,66817,81556,106294,116032,130769,130506,130242,144978,169713,179448,179182,183916,178649,188382,
198114,222845,242576,237307,227037,221766,211495,216223,215951,185678,155405,115132,109857,99583,89307,54032,28755,3479,-11799,-22077,
-27355,-42634,-72913,-78193,-73473,-73754,-74035,-84317,-114600,-139882,-130166,-125450,-125734,-126019,-156304,-171590,-156876,-152163,-132450,-147738,
-163026,-178315,-163604,-148894,-154184,-149475,-174766,-175058,-160350,-160643,-160936,-166229,-171523,-176818,-157113,-142408,-142704,-153000,-178297,-173595,
-168892,-154191,-154489,-174789,-170088,-180388,-170689,-170990,-166291,-166593,-181896,-187199,-172502,-177806,-153110,-173414,-183720,-194025,-179331,-169637,
-174944,-170252,-195559,-210868,-211176,-171485,-166795,-167105,-172415,-187726,-188037,-168349,-168661,-178974,-174287,-189600,-169914,-190228,-175543,-170858,
-196173,-216489,-216806,-207122,-192440,-197757,-218075,-223394,-193712,-174032,-159351,-154671,-169992,-175313,-170634,-170956,-141278,-146600,-161923,-152246,
-137570,-127894,-93219,-88543,-103869,-124194,-129520,-124847,-120174,-125501,-150828,-151156,-166485,-156813,-167143,-182472,-177802,-183132,-168463,-173794,
-154125,-179457,-209789,-235121,-225454,-215788,-221121,-236455,-251789,-262124,-237459,-222794,-208130,-218466,-243803,-244140,-244477,-234814,-230152,-235490,
-270829,-271168,-261507,-246847,-242187,-252527,-257868,-258209,-253550,-238892,-229234,-249576,-239918,-245261,-240605,-220948,-216292,-216637,-236981,-237326,
-212672,-193017,-173363,-173709,-164056,-169403,-129750,-50097,19555,109207,168858,238509,333160,392811,412461,387111,336761,266411,201060,175709,
150357,160005,209653,314301,438948,583595,708242,782889,832535,832181,781826,736472,666117,590762,505406,415050,334694,259338,143981,33624,
-101733,-217090,-292448,-347806,-383164,-413522,-393881,-379240,-354599,-334959,-315319,-300679,-301039,-316400,-321761,-312122,-312483,-322844,-333206,-328568,
-333931,-309293,-289656,-310019,-325382,-330746,-321109,-311473,-311838,-302202,-307567,-322932,-323297,-303662,-309028,-294393,-309759,-315126,-295492,-285859,
-256226,-266593,-276960,-287328,-282696,-278064,-258432,-248800,-259169,-254538,-239907,-230276,-215645,-211015,-211385,-216755,-202125,-172495,-162866,-153237,
-168608,-148979,-139350,-119722,-105093,-95465,-95838,-91210,-81582,-41955,-22328,-2701,-28074,-23447,1179,20806,50432,65058,74684,84309,
108935,133560,163185,172810,157435,147060,151684,166309,155933,145557,110181,89805,79428,64052,48675,23298,-17079,-52456,-52833,-58210,
-63588,-83965,-109343,-119721,-115099,-110477,-120855,-106234,-141612,-136991,-137370,-132749,-118128,-133507,-143886,-154265,-134645,-130024,-130404,-135784,
-146164,-156544,-151924,-137304,-122684,-138065,-148445,-148826,-149207,-129588,-129968,-135349,-135731,-146112,-126493,-126874,-132256,-127637,-138019,-148401,
-128782,-114164,-109546,-124928,-130310,-140692,-136075,-111457,-111839,-117222,-127604,-127987,-128369,-108752,-89135,-104517,-119900,-135283,-125666,-116049,
-111432,-121815,-132199,-152582,-147965,-113348,-113732,-114115,-119498,-134882,-125265,-125649,-111033,-116416,-131800,-142183,-132567,-122951,-128335,-123718,
-144102,-149486,-154870,-140254,-130638,-141021,-146405,-146789,-152173,-137557,-122941,-133325,-153709,-159093,-144477,-124861,-105245,-105629,-121013,-131397,
-131781,-112165,-102549,-102933,-113316,-103700,-99084,-84468,-54852,-70236,-75620,-86004,-81387,-81771,-87155,-87539,-107922,-113306,-103690,-94073,
-99457,-124840,-140224,-160607,-150991,-136374,-131757,-132141,-157524,-162907,-163290,-158673,-149056,-154439,-169822,-190205,-195588,-190971,-186353,-191736,
-207119,-222501,-197884,-208266,-188648,-209031,-214413,-219795,-210177,-200559,-205941,-211323,-226704,-242086,-237468,-232849,-218231,-233612,-223993,-244374,
-229755,-225136,-210517,-230898,-231279,-226659,-237040,-202420,-207801,-203181,-208561,-228941,-209321,-189700,-175080,-165460,-160839,-146218,-111598,-36977,
42644,117265,201887,271508,301130,330751,305373,244995,169617,124239,118861,188484,308106,452729,562352,681975,796598,886221,915845,845468,
725092,619716,539340,478964,393588,263212,127837,-17538,-177913,-278288,-358663,-409038,-449412,-469787,-445161,-385535,-355909,-336282,-311656,-317029,
-317402,-297775,-293148,-308520,-308893,-324265,-309637,-310009,-300381,-305752,-321123,-321495,-311865,-297236,-292607,-292977,-323347,-323717,-314087,-304457,
-299826,-300195,-300564,-330933,-321301,-301670,-297038,-297406,-312773,-308141,-298508,-288875,-279242,-269609,-284975,-280341,-295707,-256073,-236439,-236804,
-242169,-242534,-222898,-208263,-193627,-188991,-179354,-179718,-160081,-145444,-125807,-131169,-131531,-126893,-102255,-87617,-57978,-48339,-53700,-44060,
-34420,-4780,14860,34500,49141,43782,78424,113065,117707,117349,101992,86634,86277,80920,60564,40208,4852,-25504,-35859,-41215,
-41569,-71924,-107278,-122632,-157986,-138339,-133693,-149045,-174398,-189750,-185102,-175454,-170805,-191156,-206507,-226858,-232208,-222558,-212907,-218257,
-213606,-223954,-234303,-224651,-209998,-215346,-225693,-241040,-226386,-216732,-197078,-212424,-227769,-248114,-228458,-223802,-204146,-219490,-239833,-245176,
-240519,-225861,-221203,-231544,-236885,-252226,-237567,-227907,-228247,-233586,-258926,-259264,-259603,-249941,-235279,-235616,-265953,-276290,-266626,-256962,
-247298,-267633,-272968,-273303,-273637,-268971,-254304,-269638,-279970,-285303,-280635,-280966,-261298,-271628,-276959,-302289,-292619,-272948,-263277,-278606,
-283934,-294262,-299589,-284917,-280243,-275570,-295896,-311221,-306546,-276871,-262195,-287519,-292843,-298166,-293489,-278811,-269133,-274455,-294776,-285097,
-285417,-250737,-236056,-241376,-251694,-262013,-252331,-232648,-232965,-223282,-228598,-223914,-224229,-194544,-184859,-200173,-220487,-245800,-231113,-226425,
-216737,-242049,-267360,-272670,-262981,-263291,-258600,-268909,-284217,-294526,-294833,-295140,-285447,-285753,-301059,-311365,-316670,-316974,-312278,-337582,
-347885,-343188,-328490,-313792,-314093,-329394,-349695,-374995,-365294,-335593,-345892,-351190,-366487,-366785,-362081,-347378,-337673,-347969,-348264,-368558,
-378852,-349145,-339438,-349731,-355023,-360314,-365605,-350896,-341186,-351476,-356765,-382053,-362341,-342629,-327916,-343203,-328489,-318775,-299060,-259345,
-234629,-194913,-140196,-65478,24239,78958,113676,113396,53116,-22164,-67443,-77722,-38000,36722,161445,291168,445892,590617,690341,725067,
694793,574519,479246,383974,288702,173430,38159,-117111,-272381,-387651,-477919,-563188,-623456,-653723,-643990,-594256,-534522,-499787,-485051,-485315,
-445579,-445842,-426104,-441366,-456628,-476889,-442149,-452409,-437668,-437927,-438185,-453442,-433700,-423956,-404212,-414467,-429722,-434977,-425230,-420483,
-405736,-410988,-421240,-426491,-421741,-406991,-387240,-397489,-412737,-397985,-393232,-368478,-353724,-368970,-364214,-369459,-364702,-339945,-320188,-325430,
-330671,-325912,-321152,-296392,-261631,-271869,-267107,-267344,-242581,-207817,-188053,-193288,-193522,-173756,-163989,-144222,-124454,-114686,-134916,-135147,
-95376,-70606,-50834,-56062,-46289,-46516,-26742,-1968,12807,12583,-7641,-32864,-58087,-58309,-53530,-78751,-123971,-154190,-179409,-184628,
-189846,-210063,-245279,-270495,-285710,-280925,-286139,-301353,-331565,-326778,-336989,-322200,-312411,-312620,-347830,-353038,-343246,-338453,-323660,-343866,
-359072,-374276,-349481,-339684,-329887,-340089,-365291,-380492,-370692,-355892,-346091,-361290,-386488,-376685,-376882,-357078,-357273,-357468,-382662,-402855,
-383048,-373240,-363432,-373623,-378813,-389003,-394192,-384380,-379568,-384755,-384941,-405127,-400312,-380497,-375681,-380864,-391046,-401228,-391409,-386590,
-381770,-386949,-407128,-407306,-397483,-397660,-377836,-393011,-408186,-413360,-408533,-413706,-398878,-404050,-419220,-429390,-424560,-409729,-404897,-420064,
-430231,-420397,-420563,-410727,-405892,-416055,-446218,-451380,-441541,-426702,-421862,-417022,-442180,-432339,-442496,-417653,-412809,-422964,-428119,-438273,
-438426,-408579,-393731,-393883,-399033,-404183,-394333,-384481,-374629,-384776,-389923,-405069,-380214,-360359,-355503,-355646,-390788,-385930,-371071,-371212,
-361351,-376490,-391629,-406767,-416904,-412040,-392176,-417310,-437445,-457578,-442711,-442843,-437975,-453106,-463236,-498365,-498494,-468622,-478749,-473876,
-504002,-514127,-514251,-489375,-474498,-489621,-509743,-524864,-509984,-500104,-500223,-515341,-520458,-530575,-530691,-510807,-505921,-521036,-531149,-541261,
-536373,-526485,-516595,-506705,-531814,-526922,-532030,-522137,-507243,-512349,-512454,-532558,-507661,-507764,-507866,-507967,-508068,-513168,-503267,-483365,
-453463,-458560,-453656,-423752,-358847,-263941,-184034,-99127,-44219,-24310,-9401,-29491,-104580,-214668,-284756,-294843,-234929,-110015,59900,214816,
329733,424650,504568,544487,504406,394327,274247,159169,44091,-65985,-171062,-301137,-431212,-556286,-646359,-691432,-736504,-761575,-756645,-731715,
-691784,-641852,-616919,-586986,-607052,-607118,-612182,-592246,-582309,-587372,-612433,-607494,-617555,-612614,-587673,-582731,-592788,-597845,-577901,-567956,
-553010,-553064,-563117,-583169,-568220,-563271,-543321,-548371,-553419,-548467,-543514,-523560,-513606,-503651,-513695,-523738,-503781,-478823,-473864,-468905,
-463945,-488984,-459022,-414060,-404096,-389132,-399168,-389202,-369236,-354270,-329302,-314334,-309365,-299395,-289424,-269453,-234481,-244508,-234535,-234561,
-214586,-189610,-144634,-149657,-129679,-129700,-114721,-109741,-89760,-99778,-134796,-189813,-189829,-204845,-219860,-249874,-289887,-334900,-354911,-369923,
-364933,-369942,-394951,-424960,-424967,-419974,-434980,-434985,-449989,-454993,-449996,-439998,-430000,-445000,-465000,-460000,-459998,-444996,-434993,-439990,
-454985,-469980,-464974,-439968,-434960,-434952,-459943,-459934,-454923,-444912,-434901,-434888,-444875,-459861,-449846,-439831,-429815,-434798,-459780,-474762,
-474743,-439723,-439702,-439681,-449659,-464636,-449612,-429588,-419563,-424537,-439511,-449484,-449456,-439427,-419398,-434367,-444337,-454305,-449273,-439239,
-429206,-429171,-449136,-454100,-454063,-429025,-418987,-418948,-433909,-433868,-448827,-428785,-408742,-438699,-438655,-443610,-448565,-428518,-418471,-423423,
-433375,-448326,-438276,-423225,-418174,-423122,-438069,-448015,-437961,-432906,-402850,-402793,-402736,-407678,-392619,-387560,-377500,-377439,-382377,-392315,
-382252,-352188,-327124,-337058,-336992,-331926,-336858,-316790,-316721,-326651,-346581,-361510,-346438,-356366,-356293,-356219,-371144,-386069,-370992,-370916,
-365838,-370760,-385681,-405601,-415520,-410439,-380357,-390275,-400191,-425107,-420023,-419937,-404851,-419764,-439676,-434588,-429499,-409409,-399319,-404227,
-419135,-444043,-433949,-423855,-423760,-428665,-433569,-453472,-438374,-433276,-413177,-418077,-427976,-447875,-437773,-432671,-412567,-412463,-432358,-437253,
-437147,-427040,-401932,-416824,-431715,-431605,-436495,-421383,-391272,-406159,-416046,-430932,-405817,-380702,-365586,-345469,-340352,-325233,-290114,-234995,
-174875,-109754,-64632,-14510,50613,80737,90862,35987,-33887,-118761,-163633,-138505,-83377,-3247,86883,202013,352145,472277,557410,602543,
572677,502812,412948,348084,268221,183359,88497,-11364,-116224,-221084,-315943,-425801,-510659,-595516,-620372,-620227,-615082,-594936,-584790,-569643,
-534495,-479346,-444197,-449047,-458896,-458745,-458593,-458440,-448287,-453133,-447978,-462823,-452667,-447510,-427353,-427195,-452036,-451877,-446717,-441556,
-421395,-431233,-426070,-430906,-425742,-420578,-395412,-410246,-425079,-429912,-414744,-389575,-374406,-374236,-399065,-388894,-388722,-363549,-348376,-358202,
-348027,-347852,-347676,-337499,-317322,-307144,-306966,-301786,-296606,-281426,-256245,-256063,-250880,-250697,-230513,-205329,-185144,-189958,-189772,-179585,
-164397,-154209,-129020,-118830,-128640,-123449,-108258,-88066,-62873,-47680,-47486,-42291,-27096,-1900,8297,38494,33692,28890,19090,29289,
39490,4691,-30108,-54905,-74703,-79499,-84295,-114090,-153885,-178679,-193472,-188265,-193057,-217849,-247639,-257430,-267219,-257008,-251797,-261585,
-281372,-306159,-295945,-290730,-265515,-280299,-295082,-304865,-309648,-309429,-279210,-278991,-293771,-318550,-308329,-303107,-287884,-287661,-302438,-307213,
-301988,-301763,-281537,-281310,-301083,-295855,-290626,-275397,-265168,-284937,-289707,-299475,-294243,-284011,-263777,-273544,-293309,-293074,-307839,-282603,
-267366,-277129,-291891,-311652,-311413,-286174,-275934,-280693,-305452,-315210,-309967,-294724,-284481,-294237,-298992,-323747,-318501,-303254,-278007,-287760,
-302512,-312263,-307014,-291764,-276513,-301263,-316011,-330759,-320506,-305253,-300000,-299745,-314491,-329235,-308979,-303723,-298466,-308208,-312950,-317692,
-322432,-317173,-301912,-291652,-316390,-336128,-330866,-305603,-300339,-305075,-304811,-299546,-284280,-269014,-248747,-253480,-278212,-292944,-282675,-257406,
-242136,-231865,-241595,-241323,-231051,-215779,-205506,-200232,-229958,-249684,-244408,-234133,-223857,-238580,-253303,-253025,-272747,-267469,-252190,-276910,
-296630,-296349,-306068,-280786,-275504,-280221,-299938,-324655,-319370,-294086,-288801,-303515,-348229,-352942,-337655,-337368,-312079,-316791,-331502,-341212,
-345922,-330632,-335341,-350049,-349757,-354465,-354172,-333879,-328585,-328290,-352996,-362700,-357405,-337108,-331812,-336515,-361217,-345919,-350620,-330321,
-320022,-329722,-339421,-344121,-343819,-328518,-313215,-332913,-337609,-342306,-332002,-321697,-316392,-321087,-315781,-300475,-275168,-234861,-209554,-184245,
-148937,-108628,-28319,51991,102301,147612,157923,118235,78547,18859,-35828,-50515,-35201,20113,130427,270742,406058,531373,626689,702006,
737323,722641,657958,533277,448595,368914,274234,199554,124874,10195,-124484,-239162,-358840,-438518,-498195,-537872,-577549,-592225,-571900,-511576,
-476251,-450925,-410599,-405273,-399946,-389619,-384292,-378964,-388636,-393307,-387978,-372649,-362319,-361989,-361659,-386328,-380996,-365665,-350333,-350000,
-359668,-364335,-359001,-343667,-338333,-327999,-347664,-347329,-341993,-331657,-321321,-325984,-340647,-330310,-319972,-304634,-289295,-293956,-298617,-298278,
-307938,-287598,-252257,-251916,-266575,-266234,-265892,-240550,-225207,-234864,-224521,-224178,-198834,-183490,-183145,-172800,-182455,-177110,-156764,-116418,
-91071,-95724,-90377,-90030,-84682,-49334,-28986,-28637,-28288,-32939,-12590,22760,23110,38461,48812,44163,64514,84866,105218,105570,
95922,81275,66628,71982,57336,32689,3044,-41602,-51247,-65892,-60536,-85181,-114825,-139468,-169112,-168755,-153398,-178041,-187683,-207325,
-221967,-211609,-211250,-215891,-225532,-240173,-239813,-219453,-224093,-238732,-253372,-253011,-252650,-237288,-226926,-231564,-241202,-250840,-250477,-240114,
-229751,-239388,-259024,-258660,-273296,-247932,-242567,-252202,-251837,-256472,-266106,-245741,-235375,-240008,-249642,-274275,-258909,-248542,-238174,-242807,
-242439,-257071,-256703,-236335,-230966,-240598,-245229,-264859,-254490,-244121,-228751,-243381,-248011,-262640,-252270,-241899,-231528,-241157,-270786,-285414,
-260043,-254671,-244299,-253927,-253554,-268182,-257809,-247436,-242063,-246690,-251316,-265943,-260569,-245195,-239821,-249446,-254072,-258697,-273323,-242948,
-247572,-252197,-261822,-281446,-261071,-255695,-235319,-239942,-259566,-249190,-253813,-243436,-228059,-232682,-227305,-236928,-216551,-206173,-180795,-190417,
-190039,-194661,-189283,-158905,-153526,-148148,-162769,-172390,-162011,-156632,-151253,-145874,-180494,-200115,-189735,-179355,-178975,-188595,-208215,-222835,
-227455,-217074,-216694,-216313,-225933,-245552,-245171,-234790,-219409,-224028,-248647,-268265,-272884,-257502,-252121,-246739,-266357,-280976,-270594,-270212,
-259830,-269448,-289065,-293683,-303301,-287918,-267536,-272153,-286771,-296388,-311005,-285623,-280240,-284857,-299474,-304091,-293708,-283325,-267942,-272559,
-292175,-301792,-306409,-291025,-275642,-270259,-284875,-294492,-294108,-278724,-253341,-252957,-257573,-247190,-226806,-196422,-151038,-120655,-90271,-34887,
25497,95881,151265,186649,187033,142416,82800,28184,-26432,-41048,-35664,39720,170104,335488,470872,596256,666640,707024,692408,627792,
538176,423560,293944,184328,89711,-29905,-134521,-249137,-358753,-448369,-502986,-537602,-557218,-566835,-571451,-546067,-495684,-440300,-399917,-374533,
-374150,-368766,-373383,-358000,-347617,-347233,-351850,-361467,-366084,-340701,-330318,-349935,-349552,-359169,-358787,-323404,-318021,-327639,-342256,-356874,
-341492,-321109,-300727,-310345,-319963,-329581,-324199,-308817,-298435,-293054,-297672,-307290,-296909,-271528,-256146,-265765,-265384,-265003,-274622,-254241,
-238861,-233480,-228099,-227719,-227339,-206958,-181578,-171198,-170818,-175439,-155059,-134679,-119300,-108920,-123541,-103162,-82783,-57404,-27025,-31647,
-31268,-45890,-40512,-10133,30245,30623,36000,36378,51755,72133,92510,112887,103264,103641,99018,119394,129770,110147,95523,70899,
51274,51650,17026,17401,-32224,-61849,-76474,-91099,-95725,-120350,-154976,-189602,-184228,-178855,-178481,-203108,-222735,-247362,-246989,-241616,
-221244,-225871,-245499,-250127,-254756,-259384,-244013,-253641,-263270,-282900,-267529,-262159,-241788,-241418,-271048,-275679,-270309,-244940,-234571,-244202,
-268834,-273465,-263097,-242729,-242361,-241994,-261626,-271259,-270892,-260526,-245159,-249793,-259427,-259061,-268695,-263330,-257965,-252600,-267235,-261871,
-271506,-251142,-225779,-240415,-245052,-259689,-254326,-243964,-238601,-223239,-237877,-247516,-252154,-241793,-231432,-236072,-250712,-270352,-259992,-249632,
-244273,-258914,-258555,-263197,-272838,-242480,-237123,-241765,-256408,-261051,-255695,-255338,-234982,-239626,-259271,-258916,-258561,-248206,-247851,-242497,
-247144,-271790,-246437,-226084,-210731,-210379,-220027,-224675,-214323,-198972,-173621,-188271,-197920,-192570,-177221,-161871,-156522,-166173,-155825,-145477,
-150129,-144781,-134434,-139087,-153741,-168395,-188049,-167703,-162358,-172013,-191668,-221324,-205980,-195636,-200293,-199950,-214607,-234265,-243923,-223581,
-208240,-252899,-242558,-257218,-261878,-241538,-221199,-220860,-235521,-240183,-249845,-229507,-234170,-238833,-243497,-248161,-237825,-242490,-222154,-231820,
-236485,-246151,-250818,-220485,-210152,-214819,-229487,-234155,-228824,-213493,-203162,-202832,-192502,-207172,-186843,-161515,-121186,-90858,-65531,-5203,
75124,150450,230776,266102,291427,261752,212076,137401,72724,8048,23370,88693,194015,319337,459658,554979,630300,680620,725939,691259,
646577,536896,432214,352532,237849,163166,108482,-6202,-115886,-210571,-290257,-354942,-369628,-404315,-409002,-388689,-348377,-303066,-272754,-247443};
	unsigned long long  start, end;

	// Software implementation
	printf("software FIR compute:\n");
	start = rdcycle();
	for (int i = 0; i < SIZE; i++) {
        swFIRRes[i] = fir_filter(sampled_signal[i]);
        //printf("Input: %lld\tOutput: %lld\n", sampled_signal[i], swFIRRes[i]);
    }
	end = rdcycle();
	printf("SW average cycles used:  %llu\n", (end-start)/SIZE);

	// Hardware RoCC acceleration
	printf("hardware FIR compute:\n");
	start = rdcycle();
	ROCC_INSTRUCTION_S(0, 0, 0); //X, rs1, funct
	asm volatile ("fence" ::: "memory");
	for(int i=0; i<SIZE; i++){
		asm volatile ("fence"); // make sure the data will be store back without disorder
		ROCC_INSTRUCTION_DS(0, hwFIRRes[i], sampled_signal[i], 2);
		asm volatile ("fence" ::: "memory");
		//printf("Input: %lld\tOutput: %lld\n", sampled_signal[i], hwFIRRes[i]);
	}	
	end = rdcycle();
	printf("HW average cycles used:  %llu\n", (end-start)/SIZE);

	//Compare the result 
	for(int i=0; i<SIZE; i++){
		if(swFIRRes[i] != hwFIRRes[i]){
			printf("test failed!  %lld FIR: swFIRRes: %lld, hwFIRRes: %lld\n", 
					sampled_signal[i], swFIRRes[i], hwFIRRes[i]);
			return 0;
		}
		//printf("%lld,", hwFIRRes[i]);
	}	
	
	printf("\ntest successed! \n");
	return 0;
	
}
